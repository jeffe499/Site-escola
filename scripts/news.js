(function(){function qs(s){return document.querySelector(s)}function qsa(s){return Array.from(document.querySelectorAll(s))}function parseEmbedded(id,fallback){try{var el=document.getElementById(id);if(!el)return fallback;var txt=el.textContent.trim();return txt?JSON.parse(txt):fallback}catch(e){return fallback}}var embedded=parseEmbedded('embedded-news',[]);fetch('data/news.json',{cache:'no-store'}).then(function(r){if(!r.ok)throw 1;return r.json()}).catch(function(){return embedded}).then(function(news){renderNews(news||[])});function renderNews(items){var list=qs('#news-list');if(!list)return;if(!items||items.length===0){list.innerHTML='<p class="muted">Sem not√≠cias por enquanto.</p>';return}items.sort(function(a,b){return new Date(b.date)-new Date(a.date)});list.innerHTML=items.map(function(n){var d=n.date?new Date(n.date).toLocaleDateString('pt-BR'):'';return '<article class="news-item card"><h3>'+escapeHtml(n.title)+'</h3><small>'+d+'</small><p>'+escapeHtml(n.summary)+'</p><p><button class="btn small read-more" data-id="'+n.id+'">Ler mais</button></p></article>'}).join('');Array.from(document.querySelectorAll('.read-more')).forEach(function(b){b.addEventListener('click',function(){var id=Number(this.getAttribute('data-id'));var item=items.find(function(x){return x.id===id});if(!item)return;var html='<h3>'+escapeHtml(item.title)+'</h3><small>'+(item.date?new Date(item.date).toLocaleDateString('pt-BR'):'')+'</small><p>'+escapeHtml(item.summary)+'</p>';if(item.body)html+='<div>'+escapeHtml(item.body)+'</div>';window.siteAPI.openModal(html)})})}function escapeHtml(s){if(!s)return'';return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')} })();